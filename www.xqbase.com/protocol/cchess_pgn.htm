<html>

<head>
<meta http-equiv="Content-Type"
content="text/html; charset=gb_2312-80">
<meta name="GENERATOR" content="Microsoft FrontPage Express 2.0">
<title>中国象棋电脑应用规范(四)：PGN文件格式</title>
</head>

<body background="../background.gif">

<dl>
    <div align="center"><center>
    <dt>中国象棋电脑应用规范(四)</dt>
    </center></div><div align="center"><center>
    <dt>　</dt>
    </center></div><div align="center"><center>
    <dt><font size="6" face="Arial"><strong>PGN</strong></font><font
        size="6" face="隶书">文件格式</font></dt>
    </center></div><div align="center"><center>
    <dt>　</dt>
    </center></div><div align="center"><center>
    <dt>象棋百科全书网 <font face="Times New Roman">(</font><a
        href="mailto:webmaster@xqbase.com"><font
        face="Times New Roman">webmaster@xqbase.com</font></a><font
        face="Times New Roman">)</font></dt>
    </center></div><div align="center"><center>
    <dt><font face="Times New Roman">2004</font>年<font
        face="Times New Roman">11</font>月初稿，<font
        face="Times New Roman">2006</font>年<font
        face="Times New Roman">2</font>月修订</dt>
    </center></div>
    <dt>　</dt>
    <dt><font size="5" face="楷体_GB2312"><strong>一、概述</strong></font></dt>
    <dt>　</dt>
    <dt>　　<font face="Times New Roman">PGN(Portable Game
        Notation)</font>是棋类游戏过程的文件格式，既然国际象棋以这个规范作为记录棋谱的标准，那么对于中国象棋来说，在还没有一个统一标准的今天，<font
        face="Times New Roman">PGN</font>无疑是一个好的选择。<font
        face="Times New Roman">PGN</font>文件有以下特点：</dt>
    <dt>　　<font face="Times New Roman">(1) PGN</font>文件是文本格式的，可以用任何文本编辑软件建立和修改；</dt>
    <dt>　　<font face="Times New Roman">(2) PGN</font>文件分为“标签部分”和“着法部分”，两部分都规范整齐，既方便阅读，也便于棋谱编辑软件产生和解读；</dt>
    <dt>　　<font face="Times New Roman">(3) </font>一个<font
        face="Times New Roman">PGN</font>文件允许包含多个棋局，形成简易的棋谱数据库；</dt>
    <dt>　　<font face="Times New Roman">(4) PGN</font>文件的格式是公开的，现在已经被绝大多数棋谱编辑软件所接受<font
        face="Times New Roman">(</font>仅指国际象棋，目前还没有可以产生<font
        face="Times New Roman">PGN</font>文件的中国象棋软件<font
        face="Times New Roman">)</font>。</dt>
    <dt>　</dt>
    <dt><font size="5" face="楷体_GB2312"><strong>二、标签部分</strong></font></dt>
    <dt>　</dt>
    <dt>　　<font face="Times New Roman">PGN</font>的标签都是由方括号“<font
        face="Times New Roman">[]</font>”表示的内容，每个标签占一行，它们反映了棋局的一些基本情况。中国象棋的<font
        face="Times New Roman">PGN</font>记谱规范同国际象棋类似，基本标签有：</dt>
    <dt>　　<font face="Times New Roman">(0) <strong>Game</strong></font>：游戏类型，国际象棋没有这个标签，中国象棋的<font
        face="Times New Roman">PGN</font>文件中这个标签必须放在第一位，其值必须为“<font
        face="Times New Roman">Chinese Chess</font>”；</dt>
    <dt>　　<font face="Times New Roman">(1) <strong>Event</strong></font>：比赛名；</dt>
    <dt>　　<font face="Times New Roman">(2) <strong>Site</strong></font>：比赛地点；</dt>
    <dt>　　<font face="Times New Roman">(3) <strong>Date</strong></font>：比赛日期，格式统一为“<font
        face="Times New Roman">yyyy.mm.dd</font>”；</dt>
    <dt>　　<font face="Times New Roman">(4) <strong>Round</strong></font>：比赛轮次；</dt>
    <dt>　　<font face="Times New Roman">(5) <strong>Red</strong></font>：红方棋手，不同与国际象棋的<font
        face="Times New Roman">White</font>；</dt>
    <dt>　　<font face="Times New Roman">(6) <strong>Black</strong></font>：黑方棋手；</dt>
    <dt>　　<font face="Times New Roman">(7) <strong>Result</strong></font>：比赛结果，“红先胜”用“<font
        face="Times New Roman">1-0</font>”表示，“黑先胜”用“<font
        face="Times New Roman">0-1</font>”表示，和棋用“<font
        face="Times New Roman">1/2-1/2</font>”表示，未知用“<font
        face="Times New Roman">*</font>”表示。</dt>
    <dt>　</dt>
    <dt>　　另外还要增加具有中国象棋比赛特点的信息：</dt>
    <dt>　　<font face="Times New Roman">(8) <strong>RedTeam</strong></font>和<font
        face="Times New Roman"><strong>BlackTeam</strong></font>：这是棋手所属的代表队<font
        face="Times New Roman">(</font>俱乐部、棋协、省份或国家<font
        face="Times New Roman">)</font>，它们通常写在<font
        face="Times New Roman">Red</font>和<font
        face="Times New Roman">Black</font>标签的前面；</dt>
    <dt>　　<font face="Times New Roman">(9) <strong>Opening</strong></font>、<font
        face="Times New Roman"><strong>Variation</strong></font>和<font
        face="Times New Roman"><strong>ECCO</strong></font>：开局名称、变例和<font
        face="Times New Roman">ECCO</font>编号，这些都代表开局的信息，可参考《<a
        href="../ecco/ecco_intro.htm" target="_blank">中国象棋开局编号――说明</a>》一文；</dt>
    <dt>　　这里举一个例子说明：</dt>
    <dd>　</dd>
    <dd>[Game &quot;Chinese Chess&quot;]</dd>
    <dd>[Event &quot;第24届“五羊杯”全国冠军邀请赛&quot;]</dd>
    <dd>[Site &quot;广州&quot;]</dd>
    <dd>[Date &quot;2004.01.05&quot;]</dd>
    <dd>[Round &quot;决赛(加赛)&quot;]</dd>
    <dd>[RedTeam &quot;广州&quot;]</dd>
    <dd>[Red &quot;吕钦&quot;]</dd>
    <dd>[BlackTeam &quot;广州&quot;]</dd>
    <dd>[Black &quot;许银川&quot;]</dd>
    <dd>[Result &quot;1-0&quot;]</dd>
    <dd>[Opening &quot;中炮过河炮对左三步虎&quot;]</dd>
    <dd>[ECCO &quot;B24&quot;]</dd>
    <dt>　</dt>
    <dt>　　<font face="Times New Roman">(10) <strong>FEN</strong></font>：开始局面，中局、残局和排局等摆出来的局面，作棋谱记录时通常要规定这个选项；</dt>
    <dt>　　<font face="Times New Roman">(11) <strong>Format</strong></font>：表示记谱方法，可以是<font
        face="Times New Roman"><strong>Chinese</strong>(</font>中文纵线格式<font
        face="Times New Roman">)</font>、<font
        face="Times New Roman"><strong>WXF</strong>(WXF</font>纵线格式<font
        face="Times New Roman">)</font>和<font
        face="Times New Roman"><strong>ICCS</strong>(ICCS</font>坐标格式<font
        face="Times New Roman">)</font>，默认为<font
        face="Times New Roman">Chinese</font>。</dt>
    <dt>　</dt>
    <dt>　　以下信息可以作为标签存在，也可以写在注释中：</dt>
    <dt>　　<font face="Times New Roman">(1) </font>棋手相关信息：红方有<font
        face="Times New Roman"><strong>RedTitle</strong></font>、<font
        face="Times New Roman"><strong>RedElo</strong></font>、<font
        face="Times New Roman"><strong>RedNA</strong>(</font>这项通常会被<font
        face="Times New Roman">RedTeam</font>所取代<font
        face="Times New Roman">)</font>、<font
        face="Times New Roman"><strong>RedType</strong></font>等，黑方写法雷同；</dt>
    <dt>　　<font face="Times New Roman">(2) </font>赛事相关信息：<font
        face="Times New Roman"><strong>EventDate</strong></font>、<font
        face="Times New Roman"><strong>EventSponsor</strong></font>、<font
        face="Times New Roman"><strong>Section</strong></font>、<font
        face="Times New Roman"><strong>Stage</strong></font>、<font
        face="Times New Roman"><strong>Board</strong></font>、<font
        face="Times New Roman"><strong>Time</strong></font>等；</dt>
    <dt>　　<font face="Times New Roman">(3) </font>时限：以<font
        face="Times New Roman"><strong>TimeControl</strong></font>为标签的多种表示。</dt>
    <dt>　　<font face="Times New Roman">(4) </font>对局结论，以<font
        face="Times New Roman"><strong>Termination</strong></font>为标签的多种表示。</dt>
    <dt>　　<font face="Times New Roman">(5) </font>其他，诸如<font
        face="Times New Roman"><strong>Annotator</strong></font>、<font
        face="Times New Roman"><strong>Mode</strong></font>、<font
        face="Times New Roman"><strong>PlyCount</strong></font>等，请参阅《<a
        href="http://www.chessit.net/" target="_blank">国际象棋译文苑</a>》文摘――<a
        href="pgnfen1.htm" target="_blank">关于<font
        face="Times New Roman">PGN</font>和<font
        face="Times New Roman">FEN</font>记谱规范<font
        face="Times New Roman">(</font>上<font
        face="Times New Roman">)</font></a>一文。</dt>
    <dt>　</dt>
    <dt><font size="5" face="楷体_GB2312"><strong>三、棋谱部分</strong></font></dt>
    <dt>　</dt>
    <dt>　　这部分是<font face="Times New Roman">PGN</font>的主要内容，记录了每一回合的着法、评注和结果。对于这部分内容的格式，有以下几个规定：</dt>
    <dt>　　<font face="Times New Roman">(1) </font>棋谱部分必须在标签部分的后面，棋谱部分当中不能插入标签；</dt>
    <dt>　　<font face="Times New Roman">(2) </font>每一回合都由“回合数”、“红方着法”和“黑方着法”三部分组成，回合数后面要跟“<font
        face="Times New Roman">.</font>”<font
        face="Times New Roman">(</font>句点<font
        face="Times New Roman">)</font>，三者之间用两个分隔符隔开<font
        face="Times New Roman">(</font>回合数后面的句点也不例外<font
        face="Times New Roman">)</font>，回合之间也用分隔符隔开；</dt>
    <dt>　　<font face="Times New Roman">(3) </font>着法的表示必须和<font
        face="Times New Roman">Format</font>标签相统一，如果没有<font
        face="Times New Roman">Format</font>标签，则用中文纵线格式来表示；</dt>
    <dt>　　<font face="Times New Roman">(4) </font>分割符只能是空格、制表符或换行符，一个着法当中不能有分割符<font
        face="Times New Roman">(</font>回合数也一样<font
        face="Times New Roman">)</font>；</dt>
    <dt>　　<font face="Times New Roman">(5) </font>评注用花括号“<font
        face="Times New Roman">{}</font>”表示，评注内可以是除花括号以外的任何字符<font
        face="Times New Roman">(</font>包括分割符<font
        face="Times New Roman">)</font>，评注可以插在任何着法的后面，它和着法之间必须用分割符隔开；</dt>
    <dt>　　<font face="Times New Roman">(6) </font>整个棋局结束时必须用“<font
        face="Times New Roman">1-0</font>”<font
        face="Times New Roman">(</font>红方胜<font
        face="Times New Roman">)</font>、“<font
        face="Times New Roman">0-1</font>”<font
        face="Times New Roman">(</font>黑方胜<font
        face="Times New Roman">)</font>、“<font
        face="Times New Roman">1/2-1/2</font>”<font
        face="Times New Roman">(</font>和棋<font
        face="Times New Roman">)</font>或“<font
        face="Times New Roman">*</font>”<font
        face="Times New Roman">(</font>未知<font
        face="Times New Roman">)</font>表示结果，结果和着法之间必须用分割符隔开；</dt>
    <dt>　　<font face="Times New Roman">(7) </font>结果以后只能有评注，不能有着法；如果出现标签，则说明这是下一局棋。</dt>
    <dt>　</dt>
    <dt>　　例如，下列<font face="Times New Roman">PGN</font>文件的片段是允许的：</dt>
    <dd>51. 兵五平六</dd>
    <dd>{红方这一步长将还不足以判负，</dd>
    <dd>但是下一次就要判负了。}</dd>
    <dd>将４平５</dd>
    <dd>52. 兵六平五 将５平４ 53. 兵五平六 0-1 {红方长将判负}</dd>
    <dt>　</dt>
    <dt>　　又例如，下列<font face="Times New Roman">PGN</font>文件的片段是不合理的：</dt>
    <dd>51.兵五平六 将４平５　　　　　 //
        句点后面应该加分割符</dd>
    <dd>[Format &quot;WXF&quot;] 52. P6.5 K5.4　 //
        棋谱部分不能含有标签</dd>
    <dd>53. 兵五{再平六就要判负了}平四 //
        评注不能把一个着法拆散</dd>
    <dt>　</dt>
    <dt><font size="5" face="楷体_GB2312"><strong>四、举例</strong></font></dt>
    <dt>　</dt>
    <dt>　　下面是一个很经典的例子，这个例子能很好地反映中国象棋<font
        face="Times New Roman">PGN</font>格式的特点：</dt>
</dl>

<table border="0">
    <tr>
        <td><dl>
            <dd>[Game &quot;Chinese Chess&quot;]</dd>
            <dd>[Event &quot;许银川让九子对聂棋圣&quot;]</dd>
            <dd>[Site &quot;广州&quot;]</dd>
            <dd>[Date &quot;1999.12.09&quot;]</dd>
            <dd>[Red &quot;许银川&quot;]</dd>
            <dd>[Black &quot;聂卫平&quot;]</dd>
            <dd>[Result &quot;1-0&quot;]</dd>
            <dd>[FEN &quot;rnbakabnr/9/1c5c1/p1p1p1p1p/9/9/9/1C5C1/9/RN2K2NR
                r - - 0 1&quot;]</dd>
            <dd>{　　评注：许银川</dd>
            <dd>　　象棋让九子原属茶余饭后的娱乐，不意今日却被摆上赛桌，更为离奇的是：我的对手竟是在围棋棋坛上叱咤风云的聂大帅。赛前我并不了解对手的实力，但相信以聂棋圣在围棋上所体现出来的过人智慧，必能在棋理上触类旁通。因此我在赛前也作了一些准备，在对局中更是小心翼翼，不敢掉以轻心。</dd>
            <dd>　　许银川让去５只兵和双士双相，执红先行。棋盘如右图所示。当然，PGN文件里是无法嵌入图片的。}</dd>
        </dl>
        </td>
        <td><img src="cchess_pgn.gif" width="210" height="234"></td>
    </tr>
</table>

<dl>
    <dd>1. 炮八平五 炮８平５</dd>
    <dd>{　　红方首着架中炮必走之着，聂棋圣还架中炮拼兑子力，战术对头。}</dd>
    <dd>2. 炮五进五 象７进５ 3. 炮二平五</dd>
    <dd>{　　再架中炮也属正着，如改走马八进七，则象５退７，红方帅府受攻，当然若红方仍再架中炮拼兑，那么失去双炮就难有作用了。}</dd>
    <dd>马８进７ 4. 马二进三 车９平８ 5. 马八进七
        马２进１ 6. 车九平六 车１平２</dd>
    <dd>{　　聂棋圣仍按常规战法出动主力，却忽略了红方车塞象眼的凶着，应走车１进１。}</dd>
    <dd>7. 车六进八</dd>
    <dd>{　　红车疾点象眼，局势霎时有剑拔弩张之感。这种对弈不能以常理揣度，红方只能像程咬金的三板斧一般猛攻一轮，若黑方防守得法则胜负立判。}</dd>
    <dd>炮２进７</dd>
    <dd>{　　却说聂棋圣见我来势汹汹，神色顿时颇为凝重，一番思索之后沉下底炮以攻为守，果是身手不凡。此着如改走炮２平３，则帅五平六，炮３进５，车六进一，将５进１，炮五退二，黑方不易驾驭局面。}</dd>
    <dd>8. 车一进四 炮２平１ 9. 马七进八 炮１退４
        10. 马八退七 炮１进４ 11. 马七进八 车２进２</dd>
    <dd>{　　其实黑方仍可走炮１退４，红方若续走马八退七，则仍炮１进４不变作和，因黑右车叫将红可车六退九，故不算犯规。}</dd>
    <dd>12. 炮五平八 炮１退４</dd>
    <dd>{　　劣着，导致失子，应走车２平３，红方如马八进六，则车３退１，红方无从着手。但有一点必须注意，黑车躲进暗道似与棋理相悖，故聂棋圣弃子以求局势缓和情有可原。}</dd>
    <dd>13. 炮八进五 炮１平９ 14. 炮八平三 车８进２
        15. 炮三进一 车８进２ 16. 马八进六 炮９平５</dd>
    <dd>17. 炮三平一 士６进５ 18. 马六进四 车８平５
        19. 帅五平六</dd>
    <dd>{　　可直接走马四进三叫将再踩中象。}</dd>
    <dd>车５平６ 20. 马四进三 将５平６ 21.
        车六退四 卒５进１ 22. 车六进二 炮５平７</dd>
    <dd>23. 前马退二 象５进７ 24. 马二退三 卒５进１
        25. 车六平三 卒５平６ 26. 车三进三 将６进１</dd>
    <dd>27. 后马进二 士５进６ 28. 马二进三 将６平５
        29. 前马进二</dd>
    <dd>{　　红方有些拖沓，应直接走车三平六立成绝杀。}</dd>
    <dd>将５进１ 30. 车三平六 士６退５ 31.
        马二退三 车６退１ 32. 车六退三</dd>
    <dd>{　　再擒一车，以下着法仅是聊尽人事而已。}</dd>
    <dd>车６平７ 33. 车六平三 卒６平７ 34.
        车三平五 将５平６ 35. 帅六平五 将６退１</dd>
    <dd>36. 车五进二 将６退１ 37. 车五进一 将６进１
        38. 车五平七</dd>
    <dd>{　　至此，聂棋圣认负。与此同时，另一盘围棋对弈我被屠去一条大龙，已无力再战，遂平分秋色，皆大欢喜。}</dd>
    <dd>1-0</dd>
    <dt>　</dt>
    <dt><font size="5" face="楷体_GB2312"><strong>五、变着</strong></font></dt>
    <dt>　</dt>
    <dt>　　变着用圆括号“<font face="Times New Roman">()</font>”表示，变着是以棋谱的形式对棋谱的评注，因此括号里的内容本身也是棋谱，里面还可以嵌套评注<font
        face="Times New Roman">(</font>用花括号<font
        face="Times New Roman">)</font>和变着<font
        face="Times New Roman">(</font>用圆括号<font
        face="Times New Roman">)</font>。变着针对的是括号前的着法，例如在下面一段棋谱中，变着指的是“炮２进７”改走“炮２平３”：</dt>
    <dd>　</dd>
    <dd>7. 车六进八 炮２进７ (7. ... 炮２平３ 8.
        帅五平六 炮３进５ 9. 车六进一 将５进１ 10.
        炮五退二 {黑方不易驾驭局面})</dd>
    <dt>　</dt>
    <dt><font size="5" face="楷体_GB2312"><strong>六、</strong></font><font
        size="5" face="Arial"><strong>PGN</strong></font><font
        size="5" face="楷体_GB2312"><strong>与</strong></font><font
        size="5" face="Arial"><strong>XML</strong></font></dt>
    <dt>　</dt>
    <dt><font size="3">　　如今网络技术发展飞快，棋谱要能发布在互联网上，需要一种容易被互联网应用程序所识别的格式，</font><font
        size="3" face="Times New Roman">XML</font><font size="3">无疑是一种好的选择。由于</font><font
        size="3" face="Times New Roman">PGN</font><font size="3">的标签和</font><font
        size="3" face="Times New Roman">XML</font><font size="3">的容器具有类似之处，所以</font><font
        size="3" face="Times New Roman">PGN</font><font size="3">和</font><font
        size="3" face="Times New Roman">XML</font><font size="3">的转换非常方便。目前</font><font
        size="3" face="Times New Roman">XML</font><font size="3">的棋谱规范尚未形成，但是只要照搬</font><font
        size="3" face="Times New Roman">PGN</font><font size="3">格式的内容，就不难形成一个公认的</font><font
        size="3" face="Times New Roman">XML</font><font size="3">格式。例如，上面一个实例转化为</font><font
        size="3" face="Times New Roman">XML</font><font size="3">格式的文本，就可以是以下形式：</font></dt>
    <dd>　</dd>
    <dd>&lt;pgn&gt;</dd>
    <dd>　&lt;game&gt; Chinese Chess &lt;/game&gt;</dd>
    <dd>　&lt;event&gt; 许银川让九子对聂棋圣 &lt;/event&gt;</dd>
    <dd>　&lt;site&gt; 广州 &lt;/site&gt;</dd>
    <dd>　&lt;date&gt; 1999.12.09 &lt;/date&gt;</dd>
    <dd>　&lt;red&gt; 许银川 &lt;/red&gt;</dd>
    <dd>　&lt;black&gt; 聂卫平 &lt;/black&gt;</dd>
    <dd>　&lt;result&gt; 1-0 &lt;/result&gt;</dd>
    <dd>　&lt;fen&gt; rnbakabnr/9/1c5c1/p1p1p1p1p/9/9/9/1C5C1/9/RN2K2NR
        r - - 0 1 &lt;/fen&gt;</dd>
    <dd>　&lt;comment&gt; 　　评注：许银川</dd>
    <dd>　　象棋让九子原属茶余饭后的娱乐，不意今日却被摆上赛桌，更为离奇的是：我的对手竟是在围棋棋坛上叱咤风云的聂大帅。赛前我并不了解对手的实力，但相信以聂棋圣在围棋上所体现出来的过人智慧，必能在棋理上触类旁通。因此我在赛前也作了一些准备，在对局中更是小心翼翼，不敢掉以轻心。</dd>
    <dd>　　许银川让去５只兵和双士双相，执红先行。在XML中，图片可以用超链接的形式嵌入，例如：&lt;img
        src=&quot;cchess_pgn.gif&quot;&gt;。 &lt;/comment&gt;</dd>
    <dd>　&lt;move&gt; 炮八平五 &lt;/move&gt; &lt;move&gt;
        炮８平５ &lt;/move&gt;</dd>
    <dd>　&lt;comment&gt; 以后省略…… &lt;/comment&gt;</dd>
    <dd>　&lt;end&gt; 1-0 &lt;/end&gt;</dd>
    <dd>&lt;/pgn&gt;</dd>
</dl>

<dir>
    <li>上一篇　<a href="cchess_fen.htm">中国象棋电脑应用规范<font
        face="Times New Roman">(</font>三<font
        face="Times New Roman">)</font>：<font
        face="Times New Roman">FEN</font>文件格式</a></li>
    <li>下一篇　<a href="cchess_ucci.htm">中国象棋电脑应用规范<font
        face="Times New Roman">(</font>五<font
        face="Times New Roman">)</font>：中国象棋通用引擎协议</a></li>
    <li>返　回　<a href="../protocol.htm">象棋百科全书――规则与协议</a></li>
</dir>
<div align="center"><center>

<table border="0">
    <tr>
        <td><p align="center"><a
        href="http://www.xqbase.com/" target="_blank"><img
        src="../xqbase.gif" border="0" width="88"
        height="31"></a></p>
        </td>
    </tr>
    <tr>
        <td><a href="http://www.xqbase.com/"
        target="_blank"><font size="2" face="Arial"><strong>www.xqbase.com</strong></font></a></td>
    </tr>
</table>
</center></div>
</body>
</html>
